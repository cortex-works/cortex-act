<?xml version="1.0" encoding="utf-8"?><neurosiphon><repository_map><![CDATA[# REPOSITORY_MAP
src/tools/search_tool.py
src/tools/translation_tool.py
src/training.py
src/data_preparation.py
src/gemma_client.py
src/function_registry.py
src/evaluation.py]]></repository_map><file path="src/tools/search_tool.py"><![CDATA[// ... (5 imports)
logger = logging.getLogger(__name__)
class SearchTool:
    """Tool for web search using Serper.dev API."""
    def __init__(self, config: Dict[str, Any]):
                ...
    def execute(self, parameters: Dict[str, Any]) -> Dict[str, Any]:
                ...
    def get_status(self) -> Dict[str, Any]:
                ...
    def format_results_for_display(self, search_result: Dict[str, Any]) -> str:
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file><file path="src/tools/translation_tool.py"><![CDATA[// ... (5 imports)
logger = logging.getLogger(__name__)
class TranslationTool:
    """Tool for text translation using MyMemory API."""
    def __init__(self, config: Dict[str, Any]):
                ...
    def execute(self, parameters: Dict[str, Any]) -> Dict[str, Any]:
                ...
    def _normalize_language_code(self, lang: str) -> str:
                ...
    def get_status(self) -> Dict[str, Any]:
                ...
    def get_supported_languages(self) -> Dict[str, str]:
                ...
    def format_result_for_display(self, translation_result: Dict[str, Any]) -> str:
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file><file path="src/training.py"><![CDATA[// ... (9 imports)
    AutoModelForCausalLM,
    AutoTokenizer,
    TrainingArguments,
    Trainer,
    DataCollatorForSeq2Seq
)
@dataclass
class ModelArguments:
        ...
@dataclass
class DataArguments:
        ...
class BankingAgentTrainer:
    """Trainer for banking agent fine-tuning."""
    def __init__(self, model_args: ModelArguments, data_args: DataArguments):
                ...
    def setup_model_and_tokenizer(self):
                ...
    def load_dataset(self) -> Dict[str, Dataset]:
                ...
    def tokenize_function(self, examples):
                ...
    def train(self, output_dir: str = "models/xlam-banking-agent"):
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file><file path="src/data_preparation.py"><![CDATA[// ... (6 imports)
class BankingDatasetProcessor:
    """Process Galileo AI banking dataset for xLAM-2 fine-tuning."""
    def __init__(self, model_name: str = "Salesforce/xLAM-2-1b-fc-r"):
                ...
    def load_raw_data(self) -> Tuple[List[Dict], List[Dict], List[Dict]]:
                ...
    def create_training_examples(self, scenarios: List[Dict], personas: List[Dict],
                               tools: List[Dict]) -> List[Dict]:
                ...
    def _create_system_prompt(self, persona: Dict, tools: List[Dict]) -> str:
                ...
    def _generate_assistant_response(self, goals: List[str], tools: List[Dict]) -> str:
                ...
    def prepare_for_training(self, output_dir: str = "data/processed") -> str:
                ...
    def analyze_dataset(self, scenarios: List[Dict]) -> Dict[str, Any]:
                ...
if __name__ == "__main__":
    processor = BankingDatasetProcessor()
    output_dir = processor.prepare_for_training()
    _, _, scenarios = processor.load_raw_data()
    analysis = processor.analyze_dataset(scenarios)
    print("\nDataset Analysis:")
    print(f"Total scenarios: {len(scenarios)}")
    print(f"Average goals per scenario: {analysis['goal_distribution']['mean']:.2f}")
    print(f"Average message length: {analysis['message_lengths']['mean']:.1f} words")
    print(f"Goal count distribution: {analysis['goal_distribution']['counts']}")]]></file><file path="src/gemma_client.py"><![CDATA[// ... (7 imports)
logger = logging.getLogger(__name__)
class Gemma3Client:
    """Client for interacting with Gemma 3 via Ollama with function calling capabilities."""
    def __init__(self, config_path: str = "config/gemma3_config.yaml"):
                ...
    def _load_config(self, config_path: str) -> Dict[str, Any]:
                ...
    def _load_functions(self) -> Dict[str, Any]:
                ...
    def _test_connection(self):
                ...
    def _build_system_prompt(self) -> str:
                ...
    def _extract_function_call(self, response: str) -> Tuple[Optional[Dict], str]:
                ...
    def _validate_function_call(self, function_call: Dict[str, Any]) -> bool:
                ...
    def generate(self, messages: List[Dict[str, str]],
                 include_functions: bool = True) -> Dict[str, Any]:
                ...
    def get_available_functions(self) -> List[Dict[str, Any]]:
                ...
    def get_function_schema(self, function_name: str) -> Optional[Dict[str, Any]]:
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file><file path="src/function_registry.py"><![CDATA[// ... (7 imports)
logger = logging.getLogger(__name__)
class FunctionRegistry:
    """Registry for managing and executing function calls."""
    def __init__(self, config_path: str = "config/gemma3_config.yaml"):
                ...
    def _load_config(self, config_path: str) -> Dict[str, Any]:
                ...
    def _load_tools(self):
                ...
    def execute_function(self, function_name: str, parameters: Dict[str, Any]) -> Dict[str, Any]:
                ...
    def get_available_functions(self) -> List[str]:
                ...
    def get_tool_status(self) -> Dict[str, Any]:
                ...
    def test_all_tools(self) -> Dict[str, Any]:
                ...
class BaseTool:
    """Base class for all tools."""
    def __init__(self, config: Dict[str, Any]):
                ...
    def execute(self, parameters: Dict[str, Any]) -> Any:
                ...
    def get_status(self) -> Dict[str, Any]:
                ...
    def validate_parameters(self, parameters: Dict[str, Any], required: List[str]) -> bool:
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file><file path="src/evaluation.py"><![CDATA[// ... (9 imports)
class BankingAgentEvaluator:
    """Evaluate banking agent performance on test scenarios."""
    def __init__(self, model_path: str, base_model: str = "Salesforce/xLAM-2-1b-fc-r"):
                ...
    def load_model(self):
                ...
    def generate_response(self, messages: List[Dict], tools: List[Dict] = None,
                         max_new_tokens: int = 512) -> str:
                ...
    def evaluate_action_completion(self, response: str, user_goals: List[str]) -> Dict[str, Any]:
                ...
    def evaluate_tool_selection_quality(self, response: str, expected_tools: List[str] = None) -> Dict[str, Any]:
                ...
    def evaluate_test_set(self, test_data_path: str) -> Dict[str, Any]:
                ...
    def save_evaluation_results(self, results: Dict[str, Any], output_path: str):
                ...
def main():
        ...
if __name__ == "__main__":
    main()]]></file></neurosiphon>